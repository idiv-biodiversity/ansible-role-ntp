---

- name: set time zone
  timezone:
    name: '{{ system_timezone }}'
  tags:
    - timezone

# -----------------------------------------------------------------------------
# get rid of chrony
# -----------------------------------------------------------------------------

- name: check if chrony absent
  yum:
    pkg: chrony
    state: absent
  check_mode: yes
  notify: remove chrony

- meta: flush_handlers

# -----------------------------------------------------------------------------
# install ntp
# -----------------------------------------------------------------------------

- name: install ntp
  yum:
    pkg: '{{ ntp_distro_packages | join(",") }}'

- name: configure ntp
  template:
    src: '{{ ntp_template_name }}-ntp.conf.j2'
    dest: /etc/ntp.conf
    mode: 0644
    owner: root
    group: root
  notify: restart ntpd
  tags:
    - ntp-conf

- name: enable ntpd service and assure it is started
  service:
    name: ntpd
    enabled: yes
    state: started
  tags:
    - ntp-service
    - service
    - service-ntp

...
